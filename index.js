// RFC 5322 (https://datatracker.ietf.org/doc/html/rfc5322)
const regex = '(?:(?:(?:(?:(?:(?:[A-Z]|[a-z])|\\d|!|#|\\$|%|&|\'|\\*|\\+|-|\\/|=|\\?|\\^|_|`|{|\\||}|~)+(?:(?:\\.(?:(?:[A-Z]|[a-z])|\\d|!|#|\\$|%|&|\'|\\*|\\+|-|\\/|=|\\?|\\^|_|`|{|\\||}|~)+))+)|(?:"(?:(?:(?:(?:(?:(?:[\\x09 ]*\\x0d\\x0a))?[\\x09 ]+)|(?:[\\x09 ]+(?:(?:\\x0d\\x0a[\\x09 ]+))*))?(?:(?:!|[\\x23-\\x5b]|[\\x5d-\\x7e]|(?:[\\x01-\\x08]|\\x0b|\\x0c|[\\x0e-\\x1f]|\\x7f))|(?:(?:\\\\(?:[\\x21-\\x7e]|[\\x09 ]))|(?:\\\\(?:\\x00|(?:[\\x01-\\x08]|\\x0b|\\x0c|[\\x0e-\\x1f]|\\x7f)|\\x0a|\\x0d))))))*(?:(?:(?:(?:[\\x09 ]*\\x0d\\x0a))?[\\x09 ]+)|(?:[\\x09 ]+(?:(?:\\x0d\\x0a[\\x09 ]+))*))?")|(?:(?:(?:(?:[A-Z]|[a-z])|\\d|!|#|\\$|%|&|\'|\\*|\\+|-|\\/|=|\\?|\\^|_|`|{|\\||}|~)+|(?:"(?:(?:(?:(?:(?:(?:[\\x09 ]*\\x0d\\x0a))?[\\x09 ]+)|(?:[\\x09 ]+(?:(?:\\x0d\\x0a[\\x09 ]+))*))?(?:(?:!|[\\x23-\\x5b]|[\\x5d-\\x7e]|(?:[\\x01-\\x08]|\\x0b|\\x0c|[\\x0e-\\x1f]|\\x7f))|(?:(?:\\\\(?:[\\x21-\\x7e]|[\\x09 ]))|(?:\\\\(?:\\x00|(?:[\\x01-\\x08]|\\x0b|\\x0c|[\\x0e-\\x1f]|\\x7f)|\\x0a|\\x0d))))))*(?:(?:(?:(?:[\\x09 ]*\\x0d\\x0a))?[\\x09 ]+)|(?:[\\x09 ]+(?:(?:\\x0d\\x0a[\\x09 ]+))*))?"))(?:(?:\\.(?:(?:(?:[A-Z]|[a-z])|\\d|!|#|\\$|%|&|\'|\\*|\\+|-|\\/|=|\\?|\\^|_|`|{|\\||}|~)+|(?:"(?:(?:(?:(?:(?:(?:[\\x09 ]*\\x0d\\x0a))?[\\x09 ]+)|(?:[\\x09 ]+(?:(?:\\x0d\\x0a[\\x09 ]+))*))?(?:(?:!|[\\x23-\\x5b]|[\\x5d-\\x7e]|(?:[\\x01-\\x08]|\\x0b|\\x0c|[\\x0e-\\x1f]|\\x7f))|(?:(?:\\\\(?:[\\x21-\\x7e]|[\\x09 ]))|(?:\\\\(?:\\x00|(?:[\\x01-\\x08]|\\x0b|\\x0c|[\\x0e-\\x1f]|\\x7f)|\\x0a|\\x0d))))))*(?:(?:(?:(?:[\\x09 ]*\\x0d\\x0a))?[\\x09 ]+)|(?:[\\x09 ]+(?:(?:\\x0d\\x0a[\\x09 ]+))*))?"))))*))@(?:(?:(?:(?:[A-Z]|[a-z])|\\d|!|#|\\$|%|&|\'|\\*|\\+|-|\\/|=|\\?|\\^|_|`|{|\\||}|~)+(?:(?:\\.(?:(?:[A-Z]|[a-z])|\\d|!|#|\\$|%|&|\'|\\*|\\+|-|\\/|=|\\?|\\^|_|`|{|\\||}|~)+))+)|(?:\\[(?:(?:(?:(?:(?:(?:[\\x09 ]*\\x0d\\x0a))?[\\x09 ]+)|(?:[\\x09 ]+(?:(?:\\x0d\\x0a[\\x09 ]+))*))?(?:[\\x21-\\x5a]|[\\x5e-\\x7e]|(?:(?:[\\x01-\\x08]|\\x0b|\\x0c|[\\x0e-\\x1f]|\\x7f)|(?:(?:\\\\(?:[\\x21-\\x7e]|[\\x09 ]))|(?:\\\\(?:\\x00|(?:[\\x01-\\x08]|\\x0b|\\x0c|[\\x0e-\\x1f]|\\x7f)|\\x0a|\\x0d)))))))*(?:(?:(?:(?:[\\x09 ]*\\x0d\\x0a))?[\\x09 ]+)|(?:[\\x09 ]+(?:(?:\\x0d\\x0a[\\x09 ]+))*))?])|(?:(?:(?:[A-Z]|[a-z])|\\d|!|#|\\$|%|&|\'|\\*|\\+|-|\\/|=|\\?|\\^|_|`|{|\\||}|~)+(?:(?:\\.(?:(?:[A-Z]|[a-z])|\\d|!|#|\\$|%|&|\'|\\*|\\+|-|\\/|=|\\?|\\^|_|`|{|\\||}|~)+))*))))';

export default function emailRegex({exact} = {}) {
	return exact ? new RegExp(`^${regex}$`) : new RegExp(regex, 'g');
}
